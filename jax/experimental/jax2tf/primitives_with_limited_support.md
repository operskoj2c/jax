# Primitives with limited support

*Last generated on (YYYY-MM-DD): 2020-09-17*

## Updating the documentation

This file is automatically generated by running the jax2tf tests in
`jax/experimental/jax2tf/tests/primitives_test.py` and
`jax/experimental/jax2tf/tests/control_flow_ops_test.py` with the
`JAX2TF_OUTPUT_LIMITATIONS` and `JAX_ENABLE_X64` environment variables set.

## Generated summary of primitives with limited support

The following JAX primitives are converted to Tensorflow but the result of the
conversion may trigger runtime errors when run on certain devices and with
certain data types. Note that some of these primitives have unimplemented
cases even for JAX, e.g., sort does not work for complex numbers on TPUs.
This table includes only those cases that **work** in JAX but **fail** after
conversion to Tensorflow.

| Affected primitive | Type of limitation | Description | Affected dtypes | Affected devices |
| --- | --- | --- | --- | --- |
| acosh | Missing TF support | Primitive is unimplemented | float16 | CPU, GPU, TPU |
| acosh | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| add | Missing TF support | Primitive is unimplemented | uint16, uint32, uint64 | CPU, GPU, TPU |
| asinh | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| asinh | Missing TF support | Primitive is unimplemented | float16 | CPU, GPU, TPU |
| atan2 | Missing TF support | Primitive is unimplemented | bfloat16, float16 | CPU, GPU, TPU |
| atanh | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| atanh | Missing TF support | Primitive is unimplemented | float16 | CPU, GPU, TPU |
| bessel_i0e | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| bessel_i1e | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| conv_general_dilated | Missing TF support | Primitive is unimplemented; likely bug in the HLO -> LLVM IR lowering of XlaConv | complex64, complex128 | CPU, GPU, TPU |
| conv_general_dilated | Missing TF support | Primitive is unimplemented; batch_group_count != 1 unsupported | ALL | CPU, GPU, TPU |
| cosh | Missing TF support | Primitive is unimplemented | float16 | CPU, GPU, TPU |
| digamma | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| erf | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| erf_inv | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| erf_inv | Missing TF support | Primitive is unimplemented | float16 | CPU, GPU, TPU |
| erfc | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| fft | Missing TF support | Primitive is unimplemented; this is a problem only in compiled mode (experimental_compile=True)) | complex128, float64 | CPU, GPU, TPU |
| lgamma | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| max | Missing TF support | Primitive is unimplemented | bool, complex128, complex64, int8, uint16, uint32, uint64 | CPU, GPU, TPU |
| min | Missing TF support | Primitive is unimplemented | bool, complex128, complex64, int8, uint16, uint32, uint64 | CPU, GPU, TPU |
| mul | Missing TF support | Primitive is unimplemented | uint32, uint64 | CPU, GPU, TPU |
| nextafter | Missing TF support | Primitive is unimplemented | bfloat16, float16 | CPU, GPU, TPU |
| population_count | Missing TF support | Primitive is unimplemented | uint32, uint64 | CPU, GPU, TPU |
| qr | Missing TF support | Primitive is unimplemented | complex128, complex64 | CPU, GPU, TPU |
| reduce_window_sum | Missing TF support | Primitive is unimplemented | uint16, uint32, uint64 | CPU, GPU, TPU |
| rem | Missing TF support | Primitive is unimplemented | bfloat16, float16 | CPU, GPU, TPU |
| round | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| rsqrt | Missing TF support | Primitive is unimplemented | bfloat16 | CPU, GPU |
| scatter-add | Missing TF support | Primitive is unimplemented | complex64 | TPU |
| scatter-mul | Missing TF support | Primitive is unimplemented | complex64 | TPU |
| select_and_gather_add | Missing TF support | Primitive is unimplemented | float32, float64 | TPU |
| select_and_gather_add | Missing TF support | Primitive is unimplemented | float64 | CPU, GPU |
| sinh | Missing TF support | Primitive is unimplemented | float16 | CPU, GPU, TPU |
| sort | Missing TF support | Primitive is unimplemented | complex128, complex64 | CPU, GPU, TPU |
| sort | Missing TF support | Primitive is unimplemented; only sorting on last dimension is supported for XlaSort | ALL | CPU, GPU, TPU |
| sort | Missing TF support | Primitive is unimplemented; sorting 2 arrays where the first one is an array of booleans is not supported for XlaSort | bool | CPU, GPU, TPU |
| sort | Missing TF support | Primitive is unimplemented; sorting more than 2 arrays is not supported for XlaSort | ALL | CPU, GPU, TPU |
| sort | Missing TF support | Primitive is unimplemented; stable sort not implemented for XlaSort | ALL | CPU, GPU, TPU |
| svd | Missing TF support | Primitive is unimplemented; this works on JAX because JAX uses a custom implementation | complex128, complex64 | CPU, GPU |
| top_k | Missing TF support | Primitive is unimplemented; this is a problem only in compiled mode (experimental_compile=True)) | float64, int64, uint64 | CPU, GPU, TPU |

## Not yet implemented primitive conversions

The conversion of the following JAX primitives is not yet implemented:

`after_all`, `all_to_all`, `axis_index`, `cholesky`, `create_token`, `cummax`, `cummin`, `custom_linear_solve`, `eig`, `eigh`, `igamma_grad_a`, `infeed`, `lu`, `outfeed`, `pmax`, `pmin`, `ppermute`, `psum`, `random_gamma_grad`, `reduce`, `rng_uniform`, `triangular_solve`, `xla_pmap`

## Primitive conversions with missing tests

The following JAX primitives have a defined conversion but are known to be
missing tests:

`argmax`, `argmin`, `broadcast`, `clamp`, `complex`, `conj`, `custom_lin`, `device_put`, `dot_general`, `imag`, `integer_pow`, `real`, `rev`, `select_and_scatter`, `select_and_scatter_add`, `stop_gradient`, `tie_in`
